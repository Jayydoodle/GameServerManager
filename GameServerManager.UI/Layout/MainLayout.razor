@using GameServerManager.BAL
@using MudBlazor
@inherits LayoutComponentBase
@inject ISnackbar Snackbar

@* Required *@
<MudThemeProvider />
<MudPopoverProvider />

@* Needed for dialogs *@
<MudDialogProvider />

@* Needed for snackbars *@
<MudSnackbarProvider />

<MudLayout>
    <MudDrawer Open Elevation="0" Variant="@DrawerVariant.Persistent" Color="Color.Dark">
        <MudDrawerHeader>
            <MudText Typo="Typo.h6">Server Manager</MudText>
        </MudDrawerHeader>
        <MudNavMenu>
            <MudNavLink Icon="@Icons.Material.Filled.Home" Href="/Home">Home</MudNavLink>
            <MudNavLink Icon="@Icons.Material.Filled.Computer" Href="@Constants.Routes.ServerManagement">Servers</MudNavLink>

            @foreach(var server in GameServerService.ManagedServers)
            {
                <MudNavLink Icon="@Icons.Material.Filled.Gamepad" Class="pl-5" Href="@(Constants.Routes.ServerDetails + $"/{server.GameServerId}")">@server.DisplayName</MudNavLink>
            }

            <MudNavLink Icon="@Icons.Material.Filled.Settings" OnClick="@(() => GoTo("Settings/Users"))">Settings</MudNavLink>

        </MudNavMenu>
    </MudDrawer>
    <MudMainContent Style="padding-top: 0;">
        @Body
    </MudMainContent>
</MudLayout>
@code
{
    private bool _open = false;
    [Inject] private GameServerService GameServerService { get; set; } = null!;
    [Inject] private NavigationManager Navigation { get; set; } = null!;

    private void ToggleDrawer()
    {
        _open = !_open;
    }

    private void GoTo(string page) => Navigation.NavigateTo("/server-editor");
}
